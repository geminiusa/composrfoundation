<?php
return unserialize("a:6:{i:0;a:1:{i:0;a:5:{i:0;s:30:\"tcpfunc_JAVASCRIPT_PERMISSIONS\";i:1;a:0:{}i:2;i:1;i:3;s:0:\"\";i:4;s:0:\"\";}}i:1;a:0:{}i:2;s:22:\"JAVASCRIPT_PERMISSIONS\";i:3;N;i:4;N;i:5;s:29553:\"\$TPL_FUNCS['tcpfunc_JAVASCRIPT_PERMISSIONS']=\" echo \\\"\\\\\\\"use strict\\\\\\\";\\\\n\\\\nfunction permissions_toggle(cell)\\\\n{\\\\n	var index=cell.cellIndex;\\\\n	var table=cell.parentNode.parentNode;\\\\n	if (table.nodeName.toLowerCase()!='table') table=table.parentNode;\\\\n	var state_list=null\\\",\\n	',',\\n	\\\"state_checkbox=null;\\\\n	for (var i=0;i<table.rows.length;i++)\\\\n	{\\\\n		if (i>=1)\\\\n		{\\\\n			var cell2=table.rows[i].cells[index];\\\\n			var input=cell2.getElementsByTagName('input')[0];\\\\n			if (input)\\\\n			{\\\\n				if (!input.disabled)\\\\n				{\\\\n					if (state_checkbox==null) state_checkbox=input.checked;\\\\n					input.checked=!state_checkbox;\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n			{\\\\n				input=cell2.getElementsByTagName('select')[0];\\\\n				if (state_list==null) state_list=input.selectedIndex;\\\\n				input.selectedIndex=((state_list!=input.options.length-1)?(input.options.length-1):(input.options.length-2));\\\\n				input.disabled=false;\\\\n\\\\n				permissions_overridden(table.rows[i].id.replace(/_sp_container\\\\\\\$/\\\",\\n	',',\\n	\\\"''));\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction fade_icons_out()\\\\n{\\\\n	var icons=get_elements_by_class_name(document\\\",\\n	',',\\n	\\\"'perm_icon');\\\\n	for (var i=0;i<icons.length;i++)\\\\n	{\\\\n		set_opacity(icons[i]\\\",\\n	',',\\n	\\\"1.0);\\\\n		if (typeof window.fade_transition!='undefined') fade_transition(icons[i]\\\",\\n	',',\\n	\\\"20\\\",\\n	',',\\n	\\\"50\\\",\\n	',',\\n	\\\"-10);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction fade_icons_in()\\\\n{\\\\n	var icons=get_elements_by_class_name(document\\\",\\n	',',\\n	\\\"'perm_icon');\\\\n	for (var i=0;i<icons.length;i++)\\\\n	{\\\\n		if (typeof window.fade_transition!='undefined') fade_transition(icons[i]\\\",\\n	',',\\n	\\\"100\\\",\\n	',',\\n	\\\"50\\\",\\n	',',\\n	\\\"10);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction show_permission_setting(ob\\\",\\n	',',\\n	\\\"event)\\\\n{\\\\n	if (ob.disabled) return; // already showing default in disabled dropdown\\\\n	if (ob.done) return;\\\\n	ob.done=true;\\\\n\\\\n	if (!ob.full_setting)\\\\n	{\\\\n		var serverid;\\\\n\\\\n		if (typeof window.site_tree!='undefined')\\\\n		{\\\\n			var value=document.getElementById('tree_list').value;\\\\n\\\\n			if (value.indexOf('\\\",\\n	',',\\n	\\\"')!=-1) return; // Can't find any single value\\\",\\n	',',\\n	\\\" as multiple resources are selected\\\\n\\\\n			var node=window.site_tree.getElementByIdHack(value);\\\\n			serverid=node.getAttribute('serverid');\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n		{\\\\n			serverid=window.perm_serverid+':_new_';\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n		var url='\\\",\\n	ecv(\\\$cl,array(2),0,\\\"FIND_SCRIPT_NOHTTP\\\",array(\\\"find_permissions\\\")),\\n	\\\"?serverid='+window.encodeURIComponent(serverid)+'&x='+window.encodeURIComponent(ob.name);\\\\n		var ret=do_ajax_request(url+keep_stub()\\\",\\n	',',\\n	\\\"false);\\\\n		if (!ret) return;\\\\n		ob.full_setting=ret.responseText;\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	ob.title+=' [\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:DEFAULT_PERMISSION\\\",array()),\\n	\\\" '+ob.full_setting+']';\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction cleanup_permission_list(name)\\\\n{\\\\n	// We always try and cleanup the 'custom' option if we're choosing something else (because it's confusing for it to stay there)\\\\n	var custom_option=document.getElementById(name+'_custom_option');\\\\n	if (custom_option) custom_option.parentNode.removeChild(custom_option);\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction permissions_overridden(select)\\\\n{\\\\n	var element=document.getElementById(select+'_presets');\\\\n	if (element.options[0].id!=select+'_custom_option')\\\\n	{\\\\n		var new_option=document.createElement('option');\\\\n		set_inner_html(new_option\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PINTERFACE_LEVEL_CUSTOM\\\",array()),\\n	\\\"');\\\\n		new_option.id=select+'_custom_option';\\\\n		new_option.value='';\\\\n		element.insertBefore(new_option\\\",\\n	',',\\n	\\\"element.options[0]);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	element.selectedIndex=0;\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction copy_permission_presets(name\\\",\\n	',',\\n	\\\"value\\\",\\n	',',\\n	\\\"just_track)\\\\n{\\\\n	if (value=='') return false;\\\\n\\\\n	var made_change=false;\\\\n\\\\n	var usual_suspects=['bypass_validation_xrange_content'\\\",\\n	',',\\n	\\\"'edit_xrange_content'\\\",\\n	',',\\n	\\\"'edit_own_xrange_content'\\\",\\n	',',\\n	\\\"'delete_xrange_content'\\\",\\n	',',\\n	\\\"'delete_own_xrange_content'\\\",\\n	',',\\n	\\\"'submit_xrange_content'\\\",\\n	',',\\n	\\\"'edit_cat_xrange_content'];\\\\n	var access=[2\\\",\\n	',',\\n	\\\"3\\\",\\n	',',\\n	\\\"2\\\",\\n	',',\\n	\\\"3\\\",\\n	',',\\n	\\\"2\\\",\\n	',',\\n	\\\"1\\\",\\n	',',\\n	\\\"3]; // The minimum access level that turns on each of the above permissions\\\\n\\\\n	var holder=document.getElementById(name+'_sp_container');\\\\n	var elements=holder.getElementsByTagName('select');\\\\n	var i\\\",\\n	',',\\n	\\\"j\\\",\\n	',',\\n	\\\"test\\\",\\n	',',\\n	\\\"stub=name+'_sp_'\\\",\\n	',',\\n	\\\"name2\\\",\\n	',',\\n	\\\"x;\\\\n\\\\n	var node=null;\\\\n	if (typeof window.site_tree!='undefined') node=window.site_tree.getElementByIdHack(document.getElementById('tree_list').value.split('\\\",\\n	',',\\n	\\\"')[0]);\\\\n\\\\n	if (value!='-1')\\\\n	{\\\\n		for (i=0;i<elements.length;i++)\\\\n		{\\\\n			if (elements[i].name.indexOf('presets')!=-1) continue;\\\\n\\\\n			if (typeof window.site_tree=='undefined') elements[i].disabled=false;\\\\n			test=-1;\\\\n			name2=elements[i].name.substr(stub.length);\\\\n			x=name2.replace(/(high|mid|low)/\\\",\\n	',',\\n	\\\"'x');\\\\n\\\\n			for (j=0;j<usual_suspects.length;j++)\\\\n			{\\\\n				if (usual_suspects[j]==x)\\\\n				{\\\\n					test=(access[j]<=parseInt(value))?1:0;\\\\n					break;\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			if ((test!=-1) || ((node) && (node.getAttribute('serverid')!='_root')))\\\\n			{\\\\n				if (elements[i].selectedIndex!=test+1)\\\\n				{\\\\n					made_change=true;\\\\n					if (elements[i].selectedIndex!=test+1)\\\\n					{\\\\n						made_change=true;\\\\n						if (!just_track) elements[i].selectedIndex=test+1; // -1 is at index 0\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n	{\\\\n		for (i=0;i<elements.length;i++)\\\\n		{\\\\n			if (elements[i].name.indexOf('presets')!=-1) continue;\\\\n\\\\n			if (typeof window.site_tree=='undefined') elements[i].disabled=true;\\\\n			// Any disabled ones will be set to show the default permission rather than the \\\\\\\"use-default\\\\\\\" one\\\",\\n	',',\\n	\\\" WHILST all-global is on\\\\n			elements[i].selectedIndex=eval(elements[i].name+';')+1; // -1 is at index 0\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	if ((!just_track) && (elements.length==2) && (made_change))\\\\n	{\\\\n		window.fauxmodal_alert('\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:JUST_PRESETS\\\",array()),\\n	\\\"');\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	return made_change;\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction setup_sp_override_selector(name\\\",\\n	',',\\n	\\\"default_access\\\",\\n	',',\\n	\\\"sp\\\",\\n	',',\\n	\\\"title\\\",\\n	',',\\n	\\\"all_global)\\\\n{\\\\n	eval('window.'+name+'_sp_'+sp+'='+default_access);\\\\n	var select_element=document.getElementById(name+'_sp_'+sp);\\\\n	if (all_global)\\\\n	{\\\\n		// Any disabled ones will be set to show the default permission rather than the \\\\\\\"use-default\\\\\\\" one\\\",\\n	',',\\n	\\\" WHILST all-global is on\\\\n		select_element.selectedIndex=eval(name+'_sp_'+sp)+1; // -1 is at index 0\\\\n		if (typeof window.site_tree=='undefined') select_element.disabled=true;\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction permission_repeating(button\\\",\\n	',',\\n	\\\"name)\\\\n{\\\\n	var old_permission_copying=window.permission_copying;\\\\n\\\\n	var tr=button.parentNode.parentNode;\\\\n	var trs=tr.parentNode.getElementsByTagName('tr');\\\\n\\\\n	if (window.permission_copying) // Undo current copying\\\\n	{\\\\n		document.getElementById('copy_button_'+window.permission_copying).style.textDecoration='none';\\\\n		window.permission_copying=null;\\\\n		for (var i=0;i<trs.length;i++)\\\\n		{\\\\n			trs[i].onclick=function () {\\\",\\n	\\\"}\\\",\\n	\\\";\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	if (old_permission_copying!=name) // Starting a new copying session\\\\n	{\\\\n		button.style.textDecoration='blink';\\\\n		window.permission_copying=name;\\\\n		window.fauxmodal_alert('\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:REPEAT_PERMISSION_NOTICE\\\",array()),\\n	\\\"');\\\\n		for (var i=0;i<trs.length;i++)\\\\n		{\\\\n			if (trs[i]!=tr) trs[i].onclick=copy_permissions_function(trs[i]\\\",\\n	',',\\n	\\\"tr\\\",\\n	',',\\n	\\\"name);\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction copy_permissions_function(to_row\\\",\\n	',',\\n	\\\"from_row\\\",\\n	',',\\n	\\\"name)\\\\n{\\\\n	return function()\\\\n	{\\\\n		var inputs_to=to_row.getElementsByTagName('input');\\\\n		var inputs_from=from_row.getElementsByTagName('input');\\\\n		for (var i=0;i<inputs_to.length;i++)\\\\n		{\\\\n			inputs_to[i].checked=inputs_from[i].checked;\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		var selects_to=to_row.getElementsByTagName('select');\\\\n		var selects_from=from_row.getElementsByTagName('select');\\\\n		for (var i=0;i<selects_to.length;i++)\\\\n		{\\\\n			while (selects_to[i].options.length>0)\\\\n			{\\\\n				selects_to[i].remove(0);\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			for (var j=0;j<selects_from[i].options.length;j++)\\\\n			{\\\\n				selects_to[i].add(selects_from[i].options[j].cloneNode(true)\\\",\\n	',',\\n	\\\"null);\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			selects_to[i].selectedIndex=selects_from[i].selectedIndex;\\\\n			selects_to[i].disabled=selects_from[i].disabled;\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n// =========================================\\\\n// These are for the Permissions Tree Editor\\\\n// =========================================\\\\n\\\\nfunction update_permission_box(setting)\\\\n{\\\\n	if (typeof window.site_tree=='undefined') return;\\\\n\\\\n	if (setting.value=='')\\\\n	{\\\\n		document.getElementById('selection_form_fields').style.display='none';\\\\n		document.getElementById('selection_button').disabled=true;\\\\n		set_inner_html(document.getElementById('selection_message')\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PERMISSIONS_TREE_EDITOR_NONE_SELECTED\\\",array()),\\n	\\\"');\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n	{\\\\n		// Go through and set maximum permissions/override from those selected\\\\n		var values=setting.value.split('\\\",\\n	',',\\n	\\\"');\\\\n		var id\\\",\\n	',',\\n	\\\"name\\\",\\n	',',\\n	\\\"value\\\",\\n	',',\\n	\\\"i\\\",\\n	',',\\n	\\\"node\\\",\\n	',',\\n	\\\"j\\\",\\n	',',\\n	\\\"group\\\",\\n	',',\\n	\\\"element\\\",\\n	',',\\n	\\\"sp\\\",\\n	',',\\n	\\\"sp_title\\\",\\n	',',\\n	\\\"known_groups=[]\\\",\\n	',',\\n	\\\"known_sps=[]\\\",\\n	',',\\n	\\\"k\\\",\\n	',',\\n	\\\"html\\\",\\n	',',\\n	\\\"new_option\\\",\\n	',',\\n	\\\"num_sp_default\\\",\\n	',',\\n	\\\"num_sp\\\",\\n	',',\\n	\\\"ths\\\",\\n	',',\\n	\\\"tds\\\",\\n	',',\\n	\\\"cells\\\",\\n	',',\\n	\\\"new_cell\\\",\\n	',',\\n	\\\"row;\\\\n		var matrix=document.getElementById('enter_the_matrix').getElementsByTagName('table')[0];\\\\n		var num_sp_total=0;\\\\n		var is_cms=null;\\\\n		for (i=0;i<values.length;i++) // For all items that we are loading permissions for (we usually just do it for one\\\",\\n	',',\\n	\\\" but sometimes we load whole sets if we are batch setting permissions)\\\\n		{\\\\n			node=window.site_tree.getElementByIdHack(values[i]);\\\\n\\\\n			if (i==0) // On first iteration we do a cleanup\\\\n			{\\\\n				// Find usergroups\\\\n				for (j=0;j<node.attributes.length;j++)\\\\n				{\\\\n					if (node.attributes[j].name.substr(0\\\",\\n	',',\\n	\\\"7)=='g_view_')\\\\n					{\\\\n						group=node.attributes[j].name.substr(7);\\\\n						known_groups.push(group);\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n				// Blank out everything in the permissions box\\\",\\n	',',\\n	\\\" remove all SP's\\\\n				for (j=0;j<known_groups.length;j++)\\\\n				{\\\\n					group=known_groups[j];\\\\n					element=document.getElementById('access_'+group);\\\\n					element.checked=false;\\\\n					element=document.getElementById('access_'+group+'_presets');\\\\n					if (element.options[0].id!='access_'+group+'_custom_option')\\\\n					{\\\\n						new_option=document.createElement('option');\\\\n						set_inner_html(new_option\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PINTERFACE_LEVEL_CUSTOM\\\",array()),\\n	\\\"');\\\\n						new_option.id='access_'+group+'_custom_option';\\\\n						new_option.value='';\\\\n						element.insertBefore(new_option\\\",\\n	',',\\n	\\\"element.options[0]);\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n					element.selectedIndex=0;\\\\n\\\\n					// Delete existing SP nodes\\\\n					ths=matrix.getElementsByTagName('th');\\\\n					tds=matrix.getElementsByTagName('td');\\\\n					cells=[];\\\\n					for (k=0;k<ths.length;k++) cells.push(ths[k]);\\\\n					for (k=0;k<tds.length;k++) cells.push(tds[k]);\\\\n					for (k=0;k<cells.length;k++)\\\\n					{\\\\n						if ((cells[k].className.match(/(^|\\\\\\\\s)sp\\\\\\\\_header(\\\\\\\$|\\\\\\\\s)/)) || (cells[k].className.match(/(^|\\\\\\\\s)sp\\\\\\\\_cell(\\\\\\\$|\\\\\\\\s)/)))\\\\n						{\\\\n							cells[k].parentNode.removeChild(cells[k]);\\\\n						\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n			if ((node.getAttribute('serverid').indexOf(':cms_')!=-1) && (is_cms!==false)) is_cms=true; else is_cms=false;\\\\n\\\\n			// Set view access\\\\n			var done_group=false;\\\\n			for (j=0;j<node.attributes.length;j++)\\\\n			{\\\\n				if (node.attributes[j].name.substr(0\\\",\\n	',',\\n	\\\"7)=='g_view_')\\\\n				{\\\\n					group=node.attributes[j].name.substr(7);\\\\n					element=document.getElementById('access_'+group);\\\\n					\\\",\\n	((ecv(\\\$cl,array(),0,\\\"OCF\\\",array()).\\\"\\\"==\\\"1\\\")?(\\\"\\\\n						element.disabled=(node.getAttribute('serverid')==':') && (!done_group);\\\\n					\\\"):''),\\n	\\\"\\\\n					element.style.display=((values.length==1) && (node.getAttribute('serverid')=='_root'))?'none':'inline';\\\\n					if (!element.checked)\\\\n					{\\\\n						element.checked=(node.attributes[j].value=='true');\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n					element=document.getElementById('access_'+group);\\\\n					element.style.disabled=((values.length==1) && (node.getAttribute('serverid')=='_root'));\\\\n					done_group=true;\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n			// Create SP nodes\\\\n			num_sp=0;\\\\n			known_sps=[];\\\\n			id=node.getAttribute('id');\\\\n			if (typeof window.attributes_full=='undefined') window.attributes_full=[];\\\\n			if (typeof window.attributes_full[id]=='undefined') window.attributes_full[id]=node.attributes;\\\\n			for (name in window.attributes_full[id])\\\\n			{\\\\n				value=window.attributes_full[id][name];\\\\n				if (name.substr(0\\\",\\n	',',\\n	\\\"3)=='sp_')\\\\n				{\\\\n					sp=name.substr(3);\\\\n					sp_title=value;\\\\n					for (k=0;k<known_groups.length;k++)\\\\n					{\\\\n						group=known_groups[k];\\\\n\\\\n						element=document.getElementById('access_'+group+'_sp_'+sp);\\\\n						if (!element) // We haven't added it yet for one of the resources we're doing permissions for\\\\n						{\\\\n							if (k==0)\\\\n							{\\\\n								row=matrix.getElementsByTagName('tr')[0];\\\\n								new_cell=row.insertBefore(document.createElement('th')\\\",\\n	',',\\n	\\\"row.cells[row.cells.length-1]);\\\\n								new_cell.className='sp_header';\\\\n								set_inner_html(new_cell\\\",\\n	',',\\n	\\\"'<img class=\\\\\\\"gd_text\\\\\\\" src=\\\\\\\"'+'\\\",\\n	\\\"http://localhost/combs\\\",\\n	\\\"'.replace(/^https?:/\\\",\\n	',',\\n	\\\"window.location.protocol)+'/data/gd_text.php?color='+window.column_color+'&amp;text='+window.encodeURIComponent(sp_title)+escape_html(keep_stub())+'\\\\\\\" title=\\\\\\\"'+escape_html(sp_title)+'\\\\\\\" alt=\\\\\\\"'+escape_html(sp_title)+'\\\\\\\" />');\\\\n\\\\n								num_sp_total++;\\\\n							\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n							// Manually build up cell\\\\n							row=document.getElementById('access_'+group+'_sp_container');\\\\n							new_cell=row.insertBefore(document.createElement('td')\\\",\\n	',',\\n	\\\"row.cells[row.cells.length-1]);\\\\n							new_cell.className='form_table_field_input sp_cell';\\\\n							set_inner_html(new_cell\\\",\\n	',',\\n	\\\"'<div class=\\\\\\\"accessibility_hidden\\\\\\\"><label for=\\\\\\\"access_'+group+'_sp_'+sp+'\\\\\\\">\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:OVERRIDE\\\",array()),\\n	\\\"</label></div><select title=\\\\\\\"'+escape_html(sp_title)+'\\\\\\\" onmouseover=\\\\\\\"if (this.options[this.selectedIndex].value==\\\\\\\\'-1\\\\\\\\') show_permission_setting(this\\\",\\n	',',\\n	\\\"event);\\\\\\\" id=\\\\\\\"access_'+group+'_sp_'+sp+'\\\\\\\" name=\\\\\\\"access_'+group+'_sp_'+sp+'\\\\\\\"><option selected=\\\\\\\"selected\\\\\\\" value=\\\\\\\"-1\\\\\\\">/</option><option value=\\\\\\\"0\\\\\\\">\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:NO_COMPACT\\\",array()),\\n	\\\"</option><option value=\\\\\\\"1\\\\\\\">\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:YES_COMPACT\\\",array()),\\n	\\\"</option></select>');\\\\n\\\\n							element=document.getElementById('access_'+group+'_sp_'+sp);\\\\n\\\\n							setup_sp_override_selector('access_'+group\\\",\\n	',',\\n	\\\"'-1'\\\",\\n	',',\\n	\\\"sp\\\",\\n	',',\\n	\\\"sp_title\\\",\\n	',',\\n	\\\"false);\\\\n						\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n						element.options[0].disabled=((values.length==1) && (node.getAttribute('serverid')=='_root'));\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n					known_sps.push(sp);\\\\n					num_sp++;\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n			// Set SP's for all usergroups (to highest permissions from all usergroups selected)\\\\n			for (name in window.attributes_full[id])\\\\n			{\\\\n				value=window.attributes_full[id][name];\\\\n				if (name.substr(0\\\",\\n	',',\\n	\\\"4)=='gsp_')\\\\n				{\\\\n					group=name.substr(name.lastIndexOf('_')+1);\\\\n					sp=name.substr(4\\\",\\n	',',\\n	\\\"name.length-group.length-5);\\\\n					element=document.getElementById('access_'+group+'_sp_'+sp);\\\\n					if (element.selectedIndex<value+1)\\\\n						element.selectedIndex=parseInt(value)+1; // -1 corresponds to 0.\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n			// Blank out any rows of defaults\\\\n			for (k=0;k<known_groups.length;k++)\\\\n			{\\\\n				group=known_groups[k];\\\\n				num_sp_default=0;\\\\n				for (j=0;j<known_sps.length;j++)\\\\n				{\\\\n					element=document.getElementById('access_'+group+'_sp_'+known_sps[j]);\\\\n					if (element.selectedIndex==0) num_sp_default++;\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n				if (num_sp_default==num_sp)\\\\n				{\\\\n					element=document.getElementById('access_'+group+'_presets');\\\\n					element.selectedIndex=1;\\\\n					cleanup_permission_list('access_'+group);\\\\n					for (j=0;j<known_sps.length;j++)\\\\n					{\\\\n						element=document.getElementById('access_'+group+'_sp_'+known_sps[j]);\\\\n						if (typeof window.site_tree=='undefined') element.disabled=true;\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n			// Hide certain things if we only have view settings here\\\",\\n	',',\\n	\\\" else show them\\\\n			if (num_sp_total==0)\\\\n			{\\\\n				set_inner_html(matrix.getElementsByTagName('tr')[0].cells[0]\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"GROUP\\\",array()),\\n	\\\"');\\\\n				for (k=0;k<known_groups.length;k++)\\\\n				{\\\\n					document.getElementById('access_'+known_groups[k]+'_presets').style.display='none';\\\\n					var button=document.getElementById('access_'+known_groups[k]+'_sp_container').getElementsByTagName('button')[0]\\\\n					if (typeof button!='undefined') button.disabled=true;\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n			{\\\\n				set_inner_html(matrix.getElementsByTagName('tr')[0].cells[0]\\\",\\n	',',\\n	\\\"'<span class=\\\\\\\"heading_group\\\\\\\">\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"GROUP\\\",array()),\\n	\\\"</span> <span class=\\\\\\\"heading_presets\\\\\\\">\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PINTERFACE_PRESETS\\\",array()),\\n	\\\"</span>');\\\\n				for (k=0;k<known_groups.length;k++)\\\\n				{\\\\n					document.getElementById('access_'+known_groups[k]+'_presets').style.display='block';\\\\n					var button=document.getElementById('access_'+known_groups[k]+'_sp_container').getElementsByTagName('button')[0]\\\\n					if (typeof button!='undefined') button.disabled=false;\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n			// Test to see what we wouldn't have to make a change to get - and that is what we're set at\\\\n			for (k=0;k<known_groups.length;k++)\\\\n			{\\\\n				group=known_groups[k];\\\\n				var list=document.getElementById('access_'+group+'_presets');\\\\n				if (!copy_permission_presets('access_'+group\\\",\\n	',',\\n	\\\"'0'\\\",\\n	',',\\n	\\\"true)) list.selectedIndex=list.options.length-4;\\\\n				else if (!copy_permission_presets('access_'+group\\\",\\n	',',\\n	\\\"'1'\\\",\\n	',',\\n	\\\"true)) list.selectedIndex=list.options.length-3;\\\\n				else if (!copy_permission_presets('access_'+group\\\",\\n	',',\\n	\\\"'2'\\\",\\n	',',\\n	\\\"true)) list.selectedIndex=list.options.length-2;\\\\n				else if (!copy_permission_presets('access_'+group\\\",\\n	',',\\n	\\\"'3'\\\",\\n	',',\\n	\\\"true)) list.selectedIndex=list.options.length-1;\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n		// Set correct admin colspan\\\\n		for (var i=0;i<matrix.rows.length;i++)\\\\n		{\\\\n			if (matrix.rows[i].cells.length==3) {\\\\n				matrix.rows[i].cells[2].colSpan=num_sp_total+1;\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n		document.getElementById('selection_form_fields').style.display='block';\\\\n		document.getElementById('selection_button').disabled=false;\\\\n		set_inner_html(document.getElementById('selection_message')\\\",\\n	',',\\n	\\\"(values.length<=1)?'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PERMISSIONS_TREE_EDITOR_ONE_SELECTED\\\",array()),\\n	\\\"':'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PERMISSIONS_TREE_EDITOR_MULTI_SELECTED\\\",array()),\\n	\\\"');\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction set_permissions(setting)\\\\n{\\\\n	if (typeof window.site_tree=='undefined') return;\\\\n	if (typeof window.do_ajax_request=='undefined') return;\\\\n\\\\n	if (setting.value=='')\\\\n	{\\\\n		return; // Shouldn't get here\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n	{\\\\n		// Go through and set maximum permissions/override from those selected\\\\n		var values=setting.value.split('\\\",\\n	',',\\n	\\\"');\\\\n		var id\\\",\\n	',',\\n	\\\"i\\\",\\n	',',\\n	\\\"node\\\",\\n	',',\\n	\\\"j\\\",\\n	',',\\n	\\\"group\\\",\\n	',',\\n	\\\"element\\\",\\n	',',\\n	\\\"sp\\\",\\n	',',\\n	\\\"known_groups=[]\\\",\\n	',',\\n	\\\"k\\\",\\n	',',\\n	\\\"serverid\\\",\\n	',',\\n	\\\"set_request=''\\\",\\n	',',\\n	\\\"set_request_b\\\",\\n	',',\\n	\\\"new_value;\\\\n		for (i=0;i<values.length;i++)\\\\n		{\\\\n			node=window.site_tree.getElementByIdHack(values[i]);\\\\n			serverid=node.getAttribute('serverid');\\\\n\\\\n			// Find usergroups\\\\n			for (j=0;j<node.attributes.length;j++)\\\\n			{\\\\n				if (node.attributes[j].name.substr(0\\\",\\n	',',\\n	\\\"7)=='g_view_')\\\\n				{\\\\n					group=node.attributes[j].name.substr(7);\\\\n					known_groups.push(group);\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n			set_request_b='';\\\\n\\\\n			for (j=0;j<known_groups.length;j++)\\\\n			{\\\\n				group=known_groups[j];\\\\n\\\\n				// Set view access\\\\n				element=document.getElementById('access_'+group);\\\\n				new_value=element.checked?'true':'false';\\\\n				if (new_value!=node.getAttribute('g_view_'+group))\\\\n				{\\\\n					node.setAttribute('g_view_'+group\\\",\\n	',',\\n	\\\"new_value);\\\\n					set_request_b=set_request_b+'&'+i+'g_view_'+group+'='+((new_value=='true')?1:0);\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n			// Set SP's for all usergroups\\\\n			id=node.getAttribute('id');\\\\n			if (typeof window.attributes_full=='undefined') window.attributes_full=[];\\\\n			if (typeof window.attributes_full[id]=='undefined') window.attributes_full[id]=node.attributes;\\\\n			for (var name in window.attributes_full[id])\\\\n			{\\\\n				var value=window.attributes_full[id][name];\\\\n				if (name.substr(0\\\",\\n	',',\\n	\\\"3)=='sp_')\\\\n				{\\\\n					for (j=0;j<known_groups.length;j++)\\\\n					{\\\\n						group=known_groups[j];\\\\n						sp=name.substr(3);\\\\n						value=window.attributes_full[id]['gsp_'+sp+'_'+group];\\\\n						if (!value) value=-1;\\\\n						element=document.getElementById('access_'+group+'_sp_'+sp);\\\\n						if (element)\\\\n						{\\\\n							new_value=element.selectedIndex-1;\\\\n							if (new_value!=value)\\\\n							{\\\\n								window.attributes_full[id]['gsp_'+sp+'_'+group]=new_value;\\\\n								set_request_b=set_request_b+'&'+i+'gsp_'+sp+'_'+group+'='+new_value;\\\\n							\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n						\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n				// Update UI indicators\\\\n				set_inner_html(document.getElementById('tree_listextra_'+id)\\\",\\n	',',\\n	\\\"permissions_img_func_1(node\\\",\\n	',',\\n	\\\"id)+permissions_img_func_2(node\\\",\\n	',',\\n	\\\"id));\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n			if (set_request_b!='') set_request=set_request+'&map_'+i+'='+window.encodeURIComponent(serverid)+set_request_b;\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n		// Send AJAX request\\\\n		if (set_request!='') do_ajax_request('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"BASE_URL_NOHTTP\\\",array()),\\n	\\\"/data/site_tree.php?set_perms=1'+keep_stub()\\\",\\n	',',\\n	\\\"null\\\",\\n	',',\\n	\\\"set_request);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	window.fauxmodal_alert('\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PERMISSIONS_TREE_EDITOR_SAVED\\\",array()),\\n	\\\"');\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction permissions_img_func_1(node\\\",\\n	',',\\n	\\\"id)\\\\n{\\\\n	var temp=permissions_img_func_1_b(node\\\",\\n	',',\\n	\\\"id);\\\\n	var url=temp[0];\\\\n	var title=temp[1];\\\\n	return '<img class=\\\\\\\"vertical_alignment perm_icon\\\\\\\" src=\\\\\\\"'+url+'\\\\\\\" alt=\\\\\\\"'+title+'\\\\\\\" title=\\\\\\\"'+title+'\\\\\\\" />&nbsp;';\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction permissions_img_func_1_b(node\\\",\\n	',',\\n	\\\"id)\\\\n{\\\\n	var group=document.getElementById('group').value;\\\\n\\\\n	if (typeof id=='undefined') id=node.getAttribute('id');\\\\n\\\\n	if (typeof window.attributes_full=='undefined') window.attributes_full=[];\\\\n	if (typeof window.attributes_full[id]=='undefined') window.attributes_full[id]=node.attributes;\\\\n\\\\n	if (((window.attributes_full[id]['gsp_delete_highrange_content_'+group]) && (window.attributes_full[id]['gsp_delete_highrange_content_'+group]=='1')) ||\\\\n		 ((window.attributes_full[id]['gsp_delete_midrange_content_'+group]) && (window.attributes_full[id]['gsp_delete_midrange_content_'+group]=='1')) ||\\\\n		 ((window.attributes_full[id]['gsp_delete_lowrange_content_'+group]) && (window.attributes_full[id]['gsp_delete_lowrange_content_'+group]=='1')))\\\\n			return Array('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"IMG\\\",array(\\\"permlevels/3\\\",\\\"0\\\",\\\"default\\\")),\\n	\\\"'.replace(/^https?:/\\\",\\n	',',\\n	\\\"window.location.protocol)\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PINTERFACE_LEVEL_3\\\",array()),\\n	\\\"');\\\\n	else\\\\n	if (((window.attributes_full[id]['gsp_bypass_validation_highrange_content_'+group]) && (window.attributes_full[id]['gsp_bypass_validation_highrange_content_'+group]=='1')) ||\\\\n		 ((window.attributes_full[id]['gsp_bypass_validation_midrange_content_'+group]) && (window.attributes_full[id]['gsp_bypass_validation_midrange_content_'+group]=='1')) ||\\\\n		 ((window.attributes_full[id]['gsp_bypass_validation_lowrange_content_'+group]) && (window.attributes_full[id]['gsp_bypass_validation_lowrange_content_'+group]=='1')))\\\\n			return Array('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"IMG\\\",array(\\\"permlevels/2\\\",\\\"0\\\",\\\"default\\\")),\\n	\\\"'.replace(/^https?:/\\\",\\n	',',\\n	\\\"window.location.protocol)\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PINTERFACE_LEVEL_2\\\",array()),\\n	\\\"');\\\\n	else\\\\n	if (((window.attributes_full[id]['gsp_submit_highrange_content_'+group]) && (window.attributes_full[id]['gsp_submit_highrange_content_'+group]=='1')) ||\\\\n		 ((window.attributes_full[id]['gsp_submit_midrange_content_'+group]) && (window.attributes_full[id]['gsp_submit_midrange_content_'+group]=='1')) ||\\\\n		 ((window.attributes_full[id]['gsp_submit_lowrange_content_'+group]) && (window.attributes_full[id]['gsp_submit_lowrange_content_'+group]=='1')))\\\\n			return Array('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"IMG\\\",array(\\\"permlevels/1\\\",\\\"0\\\",\\\"default\\\")),\\n	\\\"'.replace(/^https?:/\\\",\\n	',',\\n	\\\"window.location.protocol)\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PINTERFACE_LEVEL_1\\\",array()),\\n	\\\"');\\\\n	else\\\\n	if (window.attributes_full[id]['inherits_something'])\\\\n			return Array('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"IMG\\\",array(\\\"permlevels/inherit\\\",\\\"0\\\",\\\"default\\\")),\\n	\\\"'.replace(/^https?:/\\\",\\n	',',\\n	\\\"window.location.protocol)\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PINTERFACE_LEVEL_GLOBAL\\\",array()),\\n	\\\"');\\\\n	else\\\\n	if (window.attributes_full[id]['no_sps']) return Array('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"IMG\\\",array(\\\"blank\\\",\\\"0\\\",\\\"default\\\")),\\n	\\\"'.replace(/^https?:/\\\",\\n	',',\\n	\\\"window.location.protocol)\\\",\\n	',',\\n	\\\"'');\\\\n\\\\n	return Array('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"IMG\\\",array(\\\"permlevels/0\\\",\\\"0\\\",\\\"default\\\")),\\n	\\\"'.replace(/^https?:/\\\",\\n	',',\\n	\\\"window.location.protocol)\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PINTERFACE_LEVEL_0\\\",array()),\\n	\\\"');\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction permissions_img_func_2(node\\\",\\n	',',\\n	\\\"id)\\\\n{\\\\n	var temp=permissions_img_func_2_b(node\\\",\\n	',',\\n	\\\"id);\\\\n	var url=temp[0];\\\\n	var title=temp[1];\\\\n	return '<img class=\\\\\\\"vertical_alignment\\\\\\\" src=\\\\\\\"'+url+'\\\\\\\" alt=\\\\\\\"'+title+'\\\\\\\" title=\\\\\\\"'+title+'\\\\\\\" />';\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction permissions_img_func_2_b(node\\\",\\n	',',\\n	\\\"id)\\\\n{\\\\n	if (typeof id=='undefined') id=node.getAttribute('id');\\\\n\\\\n	var group=document.getElementById('group').value;\\\\n\\\\n	if (node.getAttribute('g_view_'+group)=='true')\\\\n		return Array('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"IMG\\\",array(\\\"led_on\\\",\\\"0\\\",\\\"default\\\")),\\n	\\\"'.replace(/^https?:/\\\",\\n	',',\\n	\\\"window.location.protocol)\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PINTERFACE_VIEW\\\",array()),\\n	\\\"');\\\\n	return Array('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"IMG\\\",array(\\\"led_off\\\",\\\"0\\\",\\\"default\\\")),\\n	\\\"'.replace(/^https?:/\\\",\\n	',',\\n	\\\"window.location.protocol)\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"permissions:PINTERFACE_VIEW_NO\\\",array()),\\n	\\\"');\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction update_group_displayer(setting)\\\\n{\\\\n	if (typeof window.site_tree=='undefined') return;\\\\n\\\\n	set_inner_html(document.getElementById('group_name')\\\",\\n	',',\\n	\\\"escape_html(window.usergroup_titles[setting.options[setting.selectedIndex].value]));\\\\n	var html=document.getElementById('tree_list__root_tree_list');\\\\n	set_inner_html(html\\\",\\n	',',\\n	\\\"'');\\\\n	window.site_tree.render_tree(window.site_tree.tree_list_data\\\",\\n	',',\\n	\\\"html);\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n\\\";\";\n\";}");

?>